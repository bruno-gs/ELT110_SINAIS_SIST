%%% Análise de sistemas%%% 0 - Boas práticas clear all;          % limpa as variáveisclose all;          % fecha todas as figurasclc;                % limpa a telapkg load symbolic;  % carrega o pacote simbólico - Octavepkg load control;   % carrega o pacote de controle%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 1 - Preparação do código - variáveis globais e configuráveisN   =   10;         % número de harmônicas%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 2 - Modelagem do sinal de entrada - x(t)%% onda quadrada - x(t) - parametrizadaA1  =   1;           % amplitude nível altoA2  =   0;           % amplitude nível baixotau =   1;           % largura do pulsoTo  =   2;           % período do sinal%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 2.1 - Modelagem do sinal%% valores calculadoswo  = 2*pi/To;       % frequência angularfo  = 1/To;          % frequência fundamentaln   = [-N:1:N];      % número de harmônicasf   = n*fo;          % frequência das harmônicas%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3 - Análise de Fourier%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3.1 - Análise simbólicasyms n tDn  = inv(To)*int(A1*exp(-j*n*wo*t),t,0,tau) + inv(To)*int(A2*exp(-j*n*wo*t),t,tau,To)D_o = inv(To)*int(A1,t,0,tau) + inv(To)*int(A2,t,tau,To)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3.2 - Determinando o valores numéricosn   =   [-N:1:N];      % número de harmônicasDn  =   eval(Dn);      % valores numéricosD_o =   eval(D_o);     % valor médioDn(N+1) = D_o;         % subistituindo no vetor Dn%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3.3 - Determina a potência do sinal %% no tempoPg  =   inv(To)*int(A1^2,t,0,tau) + inv(To)*int(A2^2,t,tau,To);Pg  =   eval(Pg);%% na frequênciaVetor  = [abs(Dn(N+1))^2  2*abs(Dn(N+2:end)).^2];Pgn    = cumsum(Vetor);clc;                      % limpa os avisos anterioresbanda = (Pgn(end)/Pg)*100 % ocupação de potência na banda%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 4 - Filtro passa baixas - L = 0wc  =    2*pi*0.7;                % frequência de corte do filtroH     =    tf(wc,[1 wc]);         % função de transferência do filtroHFPB  =  @(w,wc)  wc./(j*w+wc);   % quando L = 0%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 5 -  Determinando a saída do filtroDny = Dn.*HFPB(2*pi*f,wc);      % saída: Y(nwo) = X(nwo)*H(nwo)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 6 -  Síntese da entrada e saída%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 6.1 - Definindo o tempoM   =   1000;         % número de pontos de simulaçãoTs  =   To/M;         % resoluçãotempo = [0:Ts:To];    % vetor tempo%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 6.2 - Sínteseauxe   =   0;          % inicia a somátoria da entradaauxs   =   0;          % inicia a somátoria da saídafor k = 0:2*N         % N pontos omega negativo + N pontos omega positivo                      % + omnega = 0 --> 2*N+1                          auxe = auxe + Dn(k+1)*exp(j*n(k+1)*wo*tempo);    auxs = auxs + Dny(k+1)*exp(j*n(k+1)*wo*tempo);endentrada = auxe;          % sinal reconstruido ou sintetizadosaida   = auxs;          % sinal reconstruido ou sintetizado%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 7 - Visualizaçãofigure(1)subplot(1,2,1)stem(f,abs(Dn)); title('Espectro de Amplitude - entrada');xlabel('Frequencia');ylabel('Amplitude');subplot(1,2,2) stem(f,abs(Dny)); title('Espectro de Amplitude - saida');xlabel('Frequencia');ylabel('Amplitude');figure(2)subplot(2,1,1)plot(f,abs(HFPB(2*pi*f,wc)))title('Modulo');xlabel('Frequencia');ylabel('Ganho');subplot(2,1,2)plot(f,angle(HFPB(2*pi*f,wc))*180/pi)title('Fase');xlabel('Frequencia');ylabel('Ganho');figure(3)subplot(1,2,1)plot(tempo,entrada); title('Sinal x(t)');xlabel('tempo em segundos');ylabel('Amplitude');subplot(1,2,2);plot(tempo,saida); title('Sinal y(t)');xlabel('tempo em segundos');ylabel('Amplitude');